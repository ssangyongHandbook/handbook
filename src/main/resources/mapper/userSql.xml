<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTDMapper3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sns.handbook.mapper.UserMapperInter">
	<select id="getTotalCount" resultType="int">
		select count(*) from user
	</select>
	
	<!-- id와 pass 파라미터로 넘겨서 (map) 1 or 0 반환
	1이면 있는 계정 0이면 없는 계정
	-->
	<select id="loginIdPassCheck" parameterType="Map" resultType="int">
		select count(*) from user where user_id=#{user_id} and user_pass=#{user_pass}
	</select>
	
	<!-- 예지 -->
	<select id="getUserById" parameterType="String" resultType="UserDto">
		select * from user where user_id=#{user_id}
	</select>
	<select id="getUserByNum" parameterType="String" resultType="UserDto">
		select * from user where user_num=#{user_num}
	</select>

	
	<!-- 우형 시작 -->
	<!-- 마이페이지 커버 사진 변경 -->
	<update id="updateCover" parameterType="Map">
		update user set user_cover=#{user_cover} where user_num=#{user_num}
	</update>
	
	<!-- 전체 유저 num 값 넘겨주기 -->
	<select id="getAllUsers" resultType="UserDto">
		select * from user order by user_num asc
	</select>
	
	<!-- 프사 업뎃 -->
	<update id="updatePhoto" parameterType="Map">
		update user set user_photo=#{user_photo} where user_num=#{user_num}
	</update>
	
	<!-- 마이페이지 게시글 가져오기 -->
	<select id="getPost" parameterType="String" resultType="PostDto">
		select user_num,post_content,post_access,post_file,post_writeday from post where user_num=#{user_num} order by post_num desc
	</select>
	
	<!-- 정보 수정 -->
	<update id="updateUserInfo" parameterType="UserDto">
		update user set user_addr=#{user_addr},user_email=#{user_email},user_hp=#{user_hp} where user_num=#{user_num}
	</update>

	<!-- 우형 끝 -->

	<!-- 이 아래는 김희수가 구현함. -->
	<!-- 회원 가입 -->
	<insert id="insertUserInfo" parameterType="UserDto">
		insert into user (user_id,user_pass,user_name,user_hp,user_addr,user_email,user_joindate,user_gender,user_birth) values(#{user_id},#{user_pass},#{user_name},#{user_hp},#{user_addr},#{user_email},now(),#{user_gender},#{user_birth});
	</insert>
	
	<!-- id로 dto 반환 -->
	<select id="getUserDtoById" parameterType="String" resultType="UserDto">
		select * from user where user_id=#{user_id}
	</select>
	
	<!-- email넘겨서 이미 등록된 이메일이면 0 없는 이메일이면 1 -->
	<select id="loginEmailCheck" parameterType="String" resultType="int">
		select count(*) from user where user_email=#{user_email}
	</select>
	
	<!-- 여기 위까지는 김희수가 구현함. -->

</mapper>